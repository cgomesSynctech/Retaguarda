inherited RptUltimaCompraCliente: TRptUltimaCompraCliente
  Left = 206
  Top = 143
  Height = 461
  Caption = 'Clientes / Vendas'
  PixelsPerInch = 96
  TextHeight = 13
  inherited pnTitulo: TTS_MaxPanel
    Gradient.ColorStart = 14859922
    inherited lbCaption: TdxfLabel
      Width = 369
      Caption = 'Relat'#243'rio de '#218'ltima Compra do Cliente'
      Effect3D.ShadowedColor = 14859922
    end
  end
  inherited pnGrid: TPanel
    Height = 384
    inherited pnDados: TTS_Panel
      Height = 76
      Color = 16116702
      object TS_Label1: TTS_Label
        Left = 333
        Top = 19
        Width = 118
        Caption = 'Calcular a m'#233'dia para '
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        ParentFont = False
        FormatoTabela = False
        LinkToResult = 0
      end
      object TS_Label2: TTS_Label
        Left = 485
        Top = 19
        Width = 49
        Alignment = taLeftJustify
        Caption = 'meses'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        ParentFont = False
        FormatoTabela = False
        LinkToResult = 0
      end
      object TS_Label4: TTS_Label
        Left = 243
        Top = 34
        Width = 49
        Alignment = taLeftJustify
        Caption = 'dias'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        ParentFont = False
        FormatoTabela = False
        LinkToResult = 0
      end
      object spCliente: TTS_SpeedButton
        Left = 337
        Top = 48
        Width = 129
        Height = 25
        Caption = 'Escolher Cliente(s)'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        Glyph.Data = {
          52050000424D5205000000000000120300002800000018000000180000000100
          08000000000040020000D10E0000D10E0000B7000000B7000000030303000306
          0B000B0B0B00731C0B00B62A0B0011111100B62A1100C03111007B4811004060
          1100116A11001616160073311600B6311600C0311600CA31160006111C001C1C
          1C00B6401C00B6481C00A1501C001C841C000006230023232300E04023001C6A
          2300607323000B162A001C1C2A002A2A2A0073382A00EA402A008F482A00CA50
          2A00D4502A002A982A002AC02A0003113100313131008F383100EA483100F448
          3100CA503100D4603100318F310038383800A158380038603800E06038004084
          380038A13800061140002A11400048384000404040004058400048584000EA60
          4000D4734000E0734000408F4000409840004898400040A1400040CA40004848
          4800FF604800CA6A48006098480048AB4800505050006A585000FF7350002A1C
          5800405858006AAB580058CA580073D458002A5060000B60600060606000608F
          600031406A0040486A00D4846A00EAA16A00061C73003850730058607300D48F
          7300FFAB730084D4730016167B00061C7B0006237B00586A7B0073AB7B00EAB6
          7B0006238400065084000658840084848400FFCA84000B318F0011588F001658
          8F00487B8F008F8F8F008FC08F00FFCA8F00A1E08F000B2A980006319800FFD4
          98000B60A1001C73A1002A73A1003173A1007B98A100B6D4A1000B38AB000B40
          AB00116AAB00166AAB001C73AB000B48B6001150B600237BB6003884B600CAE0
          B6001148C0001150C0001673C0001C7BC0002A84C0003184C0003884C000116A
          CA00388FCA00408FCA0058A1CA006AA1CA0073ABCA001660D4001173D4001C7B
          D4002A84D4002A8FD4003898D40050A1D4007BB6D40084B6D400F4EAD4001660
          E000166AE0001673E0002A8FE000318FE00060ABE00073B6E0007BB6E000EAF4
          E000FFF4E0002A73EA00167BEA0098CAEA001673F4001C7BF4003198F40031A1
          F400FF00FF002384FF002A84FF00238FFF002A8FFF00388FFF002A98FF003198
          FF004098FF0038A1FF0050ABFF0050B6FF00FFFFFF00AAAAAAAAAAAAAAAAAAAA
          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2E
          0D0406070E0D0D0D1E47AAAAAAAAAAAAAAAAAAAAAAAAAA0D0F29294242281318
          1F0D0C382F0A0A151515444437AAAA07292942424821612148290F09230A155B
          5B4040243CAAAA07294242482255712B4848181A324B3E6E5B4D40403CAAAA43
          284248303A666D3A484818403277812C6E5B4D403CAAAAAA2A39392154595A3B
          3948144C3DA1B66C3F6E5B5B3CAAAAAAAA2003345C5C492712084C4C3CA2A298
          445B5B3CAAAAAAAA261100165D5D5D5C35512C45317675746A193CAAAAAAAA50
          1100255E6F6F6F625CAAAA604F89909089644AAAAAAAAA260201677879797978
          5658AAAA9BA7A7A7A7A468AAAAAAAA1105107983838383827053AA88ABAFAFAD
          ABABA44EAAAAAA0B11057E8F999A998F7D52AA92AEB0B0B0AEAEAD69AAAAAA11
          170B79A6B2B2ACA68357AA9CB1B4B4B4B4B1AE80AAAAAA111D261B798FA3ACA7
          7E5FAA9DB4B5B5B5B5B3B191AAAAAA262626362D1C335C5C26AAAA94B49393A9
          B4B4A87AAAAAAAAA173646656B65261126AAAA80727F878685847B63AAAAAAAA
          501D505065653617AAAAAAAA7C8B95A0A58C7380AAAAAAAAAAAA41261D2650AA
          AAAAAAAA8E8B9FA09E8A80AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA978E96
          8D8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA}
        ParentFont = False
        OnClick = spClienteClick
        RepeatedClick = False
        Border = True
      end
      object tsVendedor: TTS_SpeedButton
        Left = 470
        Top = 48
        Width = 145
        Height = 25
        Caption = 'Escolher Vendedor(es)'
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        Glyph.Data = {
          52050000424D5205000000000000120300002800000018000000180000000100
          08000000000040020000D10E0000D10E0000B7000000B7000000030303000306
          0B000B0B0B00731C0B00B62A0B0011111100B62A1100C03111007B4811004060
          1100116A11001616160073311600B6311600C0311600CA31160006111C001C1C
          1C00B6401C00B6481C00A1501C001C841C000006230023232300E04023001C6A
          2300607323000B162A001C1C2A002A2A2A0073382A00EA402A008F482A00CA50
          2A00D4502A002A982A002AC02A0003113100313131008F383100EA483100F448
          3100CA503100D4603100318F310038383800A158380038603800E06038004084
          380038A13800061140002A11400048384000404040004058400048584000EA60
          4000D4734000E0734000408F4000409840004898400040A1400040CA40004848
          4800FF604800CA6A48006098480048AB4800505050006A585000FF7350002A1C
          5800405858006AAB580058CA580073D458002A5060000B60600060606000608F
          600031406A0040486A00D4846A00EAA16A00061C73003850730058607300D48F
          7300FFAB730084D4730016167B00061C7B0006237B00586A7B0073AB7B00EAB6
          7B0006238400065084000658840084848400FFCA84000B318F0011588F001658
          8F00487B8F008F8F8F008FC08F00FFCA8F00A1E08F000B2A980006319800FFD4
          98000B60A1001C73A1002A73A1003173A1007B98A100B6D4A1000B38AB000B40
          AB00116AAB00166AAB001C73AB000B48B6001150B600237BB6003884B600CAE0
          B6001148C0001150C0001673C0001C7BC0002A84C0003184C0003884C000116A
          CA00388FCA00408FCA0058A1CA006AA1CA0073ABCA001660D4001173D4001C7B
          D4002A84D4002A8FD4003898D40050A1D4007BB6D40084B6D400F4EAD4001660
          E000166AE0001673E0002A8FE000318FE00060ABE00073B6E0007BB6E000EAF4
          E000FFF4E0002A73EA00167BEA0098CAEA001673F4001C7BF4003198F40031A1
          F400FF00FF002384FF002A84FF00238FFF002A8FFF00388FFF002A98FF003198
          FF004098FF0038A1FF0050ABFF0050B6FF00FFFFFF00AAAAAAAAAAAAAAAAAAAA
          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA2E
          0D0406070E0D0D0D1E47AAAAAAAAAAAAAAAAAAAAAAAAAA0D0F29294242281318
          1F0D0C382F0A0A151515444437AAAA07292942424821612148290F09230A155B
          5B4040243CAAAA07294242482255712B4848181A324B3E6E5B4D40403CAAAA43
          284248303A666D3A484818403277812C6E5B4D403CAAAAAA2A39392154595A3B
          3948144C3DA1B66C3F6E5B5B3CAAAAAAAA2003345C5C492712084C4C3CA2A298
          445B5B3CAAAAAAAA261100165D5D5D5C35512C45317675746A193CAAAAAAAA50
          1100255E6F6F6F625CAAAA604F89909089644AAAAAAAAA260201677879797978
          5658AAAA9BA7A7A7A7A468AAAAAAAA1105107983838383827053AA88ABAFAFAD
          ABABA44EAAAAAA0B11057E8F999A998F7D52AA92AEB0B0B0AEAEAD69AAAAAA11
          170B79A6B2B2ACA68357AA9CB1B4B4B4B4B1AE80AAAAAA111D261B798FA3ACA7
          7E5FAA9DB4B5B5B5B5B3B191AAAAAA262626362D1C335C5C26AAAA94B49393A9
          B4B4A87AAAAAAAAA173646656B65261126AAAA80727F878685847B63AAAAAAAA
          501D505065653617AAAAAAAA7C8B95A0A58C7380AAAAAAAAAAAA41261D2650AA
          AAAAAAAA8E8B9FA09E8A80AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA978E96
          8D8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
          AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA}
        ParentFont = False
        OnClick = tsVendedorClick
        RepeatedClick = False
        Border = True
      end
      object EdMedia: TTS_CurrencyEdit
        Left = 455
        Top = 16
        Width = 27
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        ParentFont = False
        TabOrder = 1
        OnExit = EdMediaExit
        StyleController = DMProjeto.esClientes
        DisplayFormat = '0'
        Value = 3
        Height = 19
        StoredValues = 0
      end
      object edDias: TTS_CurrencyEdit
        Left = 213
        Top = 31
        Width = 27
        Font.Charset = DEFAULT_CHARSET
        Font.Color = clWindowText
        Font.Height = -11
        Font.Name = 'Tahoma'
        Font.Style = []
        ParentFont = False
        TabOrder = 0
        OnExit = edDiasExit
        StyleController = DMProjeto.esClientes
        DisplayFormat = '0'
        Value = 90
        Height = 19
        StoredValues = 0
      end
      object rgEscolhaCompra: TTS_RadioGroup
        Left = 3
        Top = -1
        Width = 206
        Height = 74
        ItemIndex = 0
        Items.Strings = (
          'Clientes que n'#227'o compram a mais de'
          'Clientes que compraram nos '#250'ltimos'
          'Clientes que nunca compraram')
        TabOrder = 2
        Transparent = True
      end
    end
    inherited dbgConsulta: TTS_QDBGrid
      Top = 76
      Height = 289
      Bands = <
        item
          Caption = 'Dados Cadastrais'
          Width = 480
        end
        item
          Caption = #218'ltima Venda'
          Width = 106
        end
        item
          Caption = 'Hist'#243'rico de Vendas'
          Width = 294
        end>
      KeyField = 'FAVORECIDO'
      BandColor = 15461355
      Filter.Criteria = {00000000}
      PreviewFieldName = 'PreviewEnd'
      ShowBands = True
      TS_SelectedColumn = 'CODIGO'
      object dbgConsultaFAVORECIDO: TdxDBGridMaskColumn
        Visible = False
        Width = 35
        BandIndex = 0
        RowIndex = 0
        FieldName = 'FAVORECIDO'
      end
      object dbgConsultaCODIGO: TdxDBGridMaskColumn
        Width = 59
        BandIndex = 0
        RowIndex = 0
        FieldName = 'CODIGO'
      end
      object dbgConsultaNOME: TdxDBGridMaskColumn
        Sorted = csUp
        Width = 178
        BandIndex = 0
        RowIndex = 0
        FieldName = 'NOME'
      end
      object dbgConsultaCidade: TdxDBGridColumn
        Caption = 'Cidade'
        Width = 165
        BandIndex = 0
        RowIndex = 0
        FieldName = 'CIDADE'
      end
      object dbgConsultaFONE1: TdxDBGridMaskColumn
        Width = 79
        BandIndex = 0
        RowIndex = 0
        FieldName = 'FONE1'
      end
      object dbgConsultaFAX: TdxDBGridMaskColumn
        Visible = False
        Width = 59
        BandIndex = 0
        RowIndex = 0
        FieldName = 'FAX'
      end
      object dbgConsultaULTCOMPRA: TdxDBGridDateColumn
        Width = 53
        BandIndex = 1
        RowIndex = 0
        FieldName = 'ULTCOMPRA'
      end
      object dbgConsultaULTVALORCOMPRA: TdxDBGridMaskColumn
        Width = 53
        BandIndex = 1
        RowIndex = 0
        FieldName = 'ULTVALORCOMPRA'
      end
      object dbgConsultaESTEANO: TdxDBGridMaskColumn
        Width = 71
        BandIndex = 2
        RowIndex = 0
        FieldName = 'ESTEANO'
      end
      object dbgConsultaANOPASSADO: TdxDBGridMaskColumn
        Width = 81
        BandIndex = 2
        RowIndex = 0
        FieldName = 'ANOPASSADO'
      end
      object dbgConsultaMEDIAMES: TdxDBGridMaskColumn
        Width = 77
        BandIndex = 2
        RowIndex = 0
        FieldName = 'MEDIAMES'
      end
      object dbgConsultaMEDIA: TdxDBGridMaskColumn
        Width = 100
        BandIndex = 2
        RowIndex = 0
        FieldName = 'MEDIA'
      end
    end
    inherited PainelFullSelect: TTS_Panel
      Top = 365
      inherited cbFullSelect: TTS_CheckBox
        Height = 19
      end
    end
  end
  inherited TS_Panel1: TTS_Panel
    Height = 384
    inherited btSair: TTS_SpeedButton
      Top = 339
    end
    inherited btAtualizar: TTS_SpeedButton
      OnClick = btAtualizarClick
    end
  end
  inherited ppmPadrao: TTS_PopupMenu
    Left = 370
    Top = 326
    object Endereo1: TMenuItem [0]
      Caption = 'Endere'#231'o'
      OnClick = Endereo1Click
    end
    object N9: TMenuItem [1]
      Caption = '-'
    end
  end
  inherited FormStorage: TFormStorage
    Left = 120
    Top = 224
  end
  inherited Q_Consulta: TIBQuery
    SQL.Strings = (
      
        'Select f.favorecido, f.codigo, f.nome, f.fone1, f.endereco, f.ci' +
        'dade, f.uf, f.cep, f.fax, f.fone2, f.ultcompra, f.ultvalorcompra' +
        ','
      '    (select sum(s.total)  from saidas s'
      '    where s.tipopadrao = 1 and s.situacao = '#39'N'#39
      '    and s.data between :dataiano and :datafano'
      '    and s.favorecido = f.favorecido)'
      '    as EsteAno,'
      '    (select sum(s.total)  from saidas s'
      '    where s.tipopadrao = 1 and s.situacao = '#39'N'#39
      '    and s.data between :dataianopass and :datafanopass'
      '   and s.favorecido = f.favorecido)'
      '   as AnoPassado,'
      '    (select sum(s.total)/3  from saidas s'
      '    where s.tipopadrao = 1 and s.situacao = '#39'N'#39
      '    and s.data between :dataimedia and :datafmedia'
      '    and s.favorecido = f.favorecido)'
      '    as MediaMes,'
      '    (select avg(s.total)  from saidas s'
      '    where s.tipopadrao = 1 and s.situacao = '#39'N'#39
      '    and s.data between :dataimedia and :datafmedia'
      '    and s.favorecido = f.favorecido)'
      '    as Media'
      'from favorecidos f'
      'where f.tipofavorecido=1'
      'and f.desativado = '#39'N'#39)
    Top = 110
    ParamData = <
      item
        DataType = ftDateTime
        Name = 'dataiano'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafano'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'dataianopass'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafanopass'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'dataimedia'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafmedia'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'dataimedia'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafmedia'
        ParamType = ptUnknown
      end>
  end
  inherited C_Consulta: TClientDataSet
    Params = <
      item
        DataType = ftDateTime
        Name = 'dataiano'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafano'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'dataianopass'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafanopass'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'dataimedia'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafmedia'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'dataimedia'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'datafmedia'
        ParamType = ptUnknown
      end>
    OnCalcFields = C_ConsultaCalcFields
    object C_ConsultaFAVORECIDO: TIntegerField
      FieldName = 'FAVORECIDO'
      Required = True
    end
    object C_ConsultaCODIGO: TStringField
      DisplayLabel = 'C'#243'digo'
      FieldName = 'CODIGO'
    end
    object C_ConsultaNOME: TStringField
      DisplayLabel = 'Nome'
      FieldName = 'NOME'
      Size = 50
    end
    object C_ConsultaFONE1: TStringField
      DisplayLabel = 'Fone'
      FieldName = 'FONE1'
    end
    object C_ConsultaENDERECO: TStringField
      FieldName = 'ENDERECO'
      Size = 50
    end
    object C_ConsultaCIDADE: TStringField
      FieldName = 'CIDADE'
      Size = 30
    end
    object C_ConsultaUF: TStringField
      FieldName = 'UF'
      Size = 2
    end
    object C_ConsultaCEP: TStringField
      FieldName = 'CEP'
      Size = 10
    end
    object C_ConsultaFAX: TStringField
      FieldName = 'FAX'
    end
    object C_ConsultaFONE2: TStringField
      FieldName = 'FONE2'
    end
    object C_ConsultaULTCOMPRA: TDateField
      DisplayLabel = 'Data'
      FieldName = 'ULTCOMPRA'
    end
    object C_ConsultaULTVALORCOMPRA: TFloatField
      DisplayLabel = 'Valor'
      FieldName = 'ULTVALORCOMPRA'
    end
    object C_ConsultaPreviewEnd: TStringField
      FieldKind = fkInternalCalc
      FieldName = 'PreviewEnd'
      Size = 80
    end
    object C_ConsultaESTEANO: TFloatField
      DisplayLabel = 'Este Ano'
      FieldName = 'ESTEANO'
    end
    object C_ConsultaANOPASSADO: TFloatField
      DisplayLabel = 'Ano Passado'
      FieldName = 'ANOPASSADO'
    end
    object C_ConsultaMEDIAMES: TFloatField
      DisplayLabel = 'M'#233'dia/m'#234's'
      FieldName = 'MEDIAMES'
    end
    object C_ConsultaMEDIA: TFloatField
      DisplayLabel = 'M'#233'dia/Compra'
      FieldName = 'MEDIA'
    end
  end
  inherited ppmDados: TTS_PopupMenu
    Left = 507
    Top = 337
  end
  inherited ppmLayout: TTS_PopupMenu
    Left = 440
    Top = 329
  end
  inherited ppmHelp: TTS_PopupMenu
    Left = 617
    Top = 311
    inherited Ajuda1: TMenuItem
      HelpContext = 550
    end
  end
  inherited GridPrinter: TdxComponentPrinter
    PreviewOptions.PreviewBoundsRect = {00000000000000000000000000000000}
    inherited GridPrinterLink: TdxDBGridReportLink
      DateTime = 37242.6300147685
      PrinterPage._dxMeasurementUnits_ = 2
      PrinterPage._dxLastMU_ = 2
      BuiltInReportLink = True
    end
  end
  inherited Q_SQLReport: TIBQuery
    Left = 518
    Top = 264
  end
  inherited ppmSelTemplate: TTS_PopupMenu
    Left = 672
    Top = 240
  end
  inherited Q_FullSelect: TIBQuery
    Left = 529
    Top = 321
  end
  inherited FormsComponent: TFormsComponent
    BarEndColor = 14859922
    CaptionShadow = 14859922
    FormColor = 16116702
    Modulo = 'Clientes / Vendas'
    Caption = 'Relat'#243'rio de '#218'ltima Compra do Cliente'
    OnRefresh = FormsComponentRefresh
  end
  object Q_ULTCompra: TIBQuery
    Database = DMProjeto.DB_Projeto
    Transaction = DMProjeto.IBT_Projeto
    BufferChunks = 1000
    CachedUpdates = False
    SQL.Strings = (
      'Select saida from saidas'
      'where data=:data'
      'and favorecido=:fav')
    Left = 565
    Top = 152
    ParamData = <
      item
        DataType = ftDateTime
        Name = 'data'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'fav'
        ParamType = ptUnknown
      end>
  end
end
